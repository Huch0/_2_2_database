1. 
SELECT title FROM course WHERE dept_name = 'Comp. Sci.' AND credits = 3;

2. 
SELECT distinct student.id
FROM student
JOIN takes ON student.id = takes.id
JOIN teaches ON teaches.course_id = takes.course_id
JOIN instructor ON teaches.id  = instructor.id
where instructor."name" = 'Einstein';

3.
select MAX(salary) from instructor

4.
SELECT id
FROM instructor
WHERE salary = (
    SELECT MAX(salary)
    FROM instructor
);

5.
SELECT section.course_id, section.sec_id, COUNT(takes.ID) as enrollment
FROM section 
LEFT JOIN takes ON section.course_id = takes.course_id AND section.sec_id = takes.sec_id AND section.semester = takes.semester AND section.year = takes.year
WHERE section.year = 2007 AND section.semester = 'Fall'
GROUP BY section.course_id,section.sec_id;

6.
SELECT MAX(enrollment) as max_enrollment
FROM (
    SELECT section.course_id, section.sec_id, COUNT(takes.ID) as enrollment
    FROM section 
    LEFT JOIN takes ON section.course_id = takes.course_id AND section.sec_id = takes.sec_id AND section.semester = takes.semester AND section.year = takes.year
    WHERE section.year = 2007 AND section.semester = 'Fall'
    GROUP BY section.course_id,section.sec_id
) AS enrollments;

7.
SELECT section.sec_id
FROM section 
LEFT JOIN takes ON section.course_id = takes.course_id AND section.sec_id = takes.sec_id AND section.semester = takes.semester AND section.year = takes.year
WHERE section.year = 2007 AND section.semester = 'Fall'
GROUP BY section.course_id,section.sec_id
HAVING Count(takes.ID) = (
    SELECT MAX(enrollment) as max_enrollment
	FROM (
	    SELECT section.course_id, section.sec_id, COUNT(takes.ID) as enrollment
	    FROM section 
	    LEFT JOIN takes ON section.course_id = takes.course_id AND section.sec_id = takes.sec_id AND section.semester = takes.semester AND section.year = takes.year
	    WHERE section.year = 2007 AND section.semester = 'Fall'
	    GROUP BY section.course_id,section.sec_id
	) AS max_enrollments
);


8.
SELECT distinct student.id, student.name
from student
join takes on student.id = takes.id 
join course on takes.course_id = course.course_id
where course.dept_name = 'Comp. Sci.';

9. 
SELECT takes. *
FROM takes
JOIN course ON takes.course_id = course.course_id
WHERE LOWER(course.title) LIKE '%advanced%';

10.
SELECT takes.course_id, takes.ID
FROM takes
GROUP BY takes.course_id, takes.ID
HAVING COUNT(*) >= 3
ORDER BY takes.course_id ASC;

11.
SELECT retakes.ID
FROM (
    SELECT takes.course_id, takes.ID
    FROM takes
    GROUP BY takes.course_id, takes.ID
    HAVING COUNT(*) >= 2
) AS retakes
GROUP BY retakes.ID
HAVING COUNT(*) >= 3;

12.
SELECT DISTINCT c.course_id, c.title
FROM course c
JOIN section s ON c.course_id = s.course_id
JOIN time_slot t ON s.time_slot_id = t.time_slot_id
WHERE c.dept_name = 'Comp. Sci.' AND (t.end_hr > 12 OR (t.end_hr = 12 AND t.end_min >= 0))
ORDER BY c.course_id;

